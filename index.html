<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VittaFlow 3.1 - Evolu√ß√£o Pessoal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .progress-transition { transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .dark { background-color: #020617; color: #f8fafc; }
        .dark .bg-white { background-color: #0f172a; color: #f8fafc; border-color: #1e293b; }
        @keyframes pulse-timer { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); background-color: #ef4444; } }
        .timer-running { animation: pulse-timer 1s infinite; }
    </style>
</head>
<body id="body" class="bg-slate-50 font-sans text-slate-800 pb-32 transition-colors duration-500">

    <header class="bg-white p-6 shadow-md border-b border-slate-100 flex justify-between items-center sticky top-0 z-50">
        <div>
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-gradient-to-br from-green-400 to-green-600 rounded-xl flex items-center justify-center text-white font-black shadow-lg">V</div>
                <h1 class="text-2xl font-black text-green-600 tracking-tighter">VittaFlow</h1>
            </div>
            <p id="xp-texto" class="text-[10px] font-bold text-slate-400 mt-1 uppercase tracking-widest italic">N√≠vel 1 ‚Ä¢ 0 XP</p>
        </div>
        <button onclick="toggleDarkMode()" class="p-2 bg-slate-100 dark:bg-slate-800 rounded-xl text-lg shadow-inner">üåì</button>
    </header>

    <main class="p-4 max-w-md mx-auto space-y-6">
        
        <section class="bg-gradient-to-br from-slate-800 to-slate-900 p-5 rounded-[2rem] text-white shadow-2xl">
            <h3 class="text-[10px] font-bold uppercase tracking-[0.2em] text-green-400 mb-2">Meu Foco do M√™s</h3>
            <textarea id="mural-objetivo" oninput="salvarObjetivo()" 
                class="bg-transparent w-full text-lg font-medium outline-none resize-none placeholder:text-slate-600" 
                placeholder="Ex: Correr 5km ou perder 2kg..."></textarea>
        </section>

        <section class="bg-white p-6 rounded-[2.5rem] shadow-xl border border-slate-100">
            <div class="flex justify-between mb-4 items-center">
                <h2 class="font-black text-xl italic uppercase tracking-tighter">Status Di√°rio</h2>
                <span id="porcentagem-texto" class="text-xs font-black text-green-600 bg-green-100 dark:bg-green-900/40 px-3 py-1 rounded-full">0%</span>
            </div>
            
            <div class="w-full bg-slate-100 dark:bg-slate-800 rounded-full h-5 overflow-hidden p-1">
                <div id="barra-progresso" class="bg-gradient-to-r from-green-400 to-green-600 h-full rounded-full progress-transition" style="width: 0%"></div>
            </div>

            <div class="grid grid-cols-3 gap-4 mt-8">
                <div class="text-center">
                    <span id="macro-prot" class="block text-lg font-black text-orange-500">0g</span>
                    <span class="text-[8px] uppercase font-bold text-slate-400">Prote√≠na</span>
                </div>
                <div class="text-center border-x border-slate-100 dark:border-slate-800">
                    <span id="macro-carb" class="block text-lg font-black text-blue-500">0g</span>
                    <span class="text-[8px] uppercase font-bold text-slate-400">Carbos</span>
                </div>
                <div class="text-center">
                    <span id="macro-gord" class="block text-lg font-black text-yellow-500">0g</span>
                    <span class="text-[8px] uppercase font-bold text-slate-400">Gordura</span>
                </div>
            </div>
        </section>

        <section class="bg-white dark:bg-slate-900 p-5 rounded-[2rem] flex items-center justify-between shadow-lg border border-slate-100 dark:border-slate-800">
            <div>
                <h3 class="text-[10px] font-bold uppercase tracking-widest text-slate-400">Descanso de S√©rie</h3>
                <span id="timer-display" class="text-3xl font-mono font-black">00:45</span>
            </div>
            <button id="btn-timer" onclick="toggleTimer()" class="bg-slate-900 dark:bg-green-600 text-white w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transition-all active:scale-90">
                <span id="timer-icon" class="text-2xl">‚è±Ô∏è</span>
            </button>
        </section>

        <section class="bg-white p-5 rounded-[2rem] shadow-sm border border-slate-100">
            <h2 class="font-black text-sm uppercase mb-4 tracking-widest">‚öñÔ∏è Balan√ßa</h2>
            <div class="flex gap-2">
                <input type="number" step="0.1" id="input-peso" class="flex-1 p-3 bg-slate-50 dark:bg-slate-800 rounded-2xl outline-none" placeholder="kg">
                <button onclick="registrarPeso()" class="bg-green-500 text-white px-6 rounded-2xl font-black active:scale-95 transition">OK</button>
            </div>
            <div id="historico-peso" class="mt-4 flex gap-3 overflow-x-auto py-2 scrollbar-hide"></div>
        </section>

        <section class="bg-blue-600 p-6 rounded-[2.5rem] text-white shadow-lg relative overflow-hidden">
            <div class="relative z-10">
                <h3 class="font-black text-xl italic uppercase">Hidrata√ß√£o</h3>
                <div id="container-agua" class="mt-4 flex flex-wrap gap-2 min-h-[40px] text-2xl"></div>
            </div>
            <button onclick="adicionarAgua()" class="absolute right-6 top-1/2 -translate-y-1/2 bg-white text-blue-600 w-16 h-16 rounded-[1.5rem] font-black shadow-2xl flex items-center justify-center text-3xl active:scale-110 transition-all">+</button>
        </section>

        <button onclick="compartilharNoZap()" class="w-full bg-[#25D366] text-white py-6 rounded-[2rem] font-black shadow-xl flex items-center justify-center gap-3 uppercase tracking-tighter active:scale-95 transition-all">
            üöÄ Compartilhar Evolu√ß√£o
        </button>

    </main>

    <script>
        let db = JSON.parse(localStorage.getItem('vittaFlow3_1')) || {
            kcal: 0, prot: 0, carb: 0, gord: 0, objetivo: "",
            agua: 0, xp: 0, histPeso: [], dark: false, metaKcal: 2000
        };

        let timerInterval, timeLeft = 45, isTimerRunning = false;

        function salvar() { localStorage.setItem('vittaFlow3_1', JSON.stringify(db)); }

        function toggleDarkMode() { db.dark = !db.dark; aplicarTema(); salvar(); }
        function aplicarTema() { document.getElementById('body').classList.toggle('dark', db.dark); }

        function salvarObjetivo() { db.objetivo = document.getElementById('mural-objetivo').value; salvar(); }

        function toggleTimer() {
            const btn = document.getElementById('btn-timer');
            const display = document.getElementById('timer-display');
            if (isTimerRunning) {
                clearInterval(timerInterval);
                timeLeft = 45;
                display.innerText = "00:45";
                btn.classList.remove('timer-running', 'bg-red-500');
                isTimerRunning = false;
            } else {
                isTimerRunning = true;
                btn.classList.add('timer-running', 'bg-red-500');
                timerInterval = setInterval(() => {
                    timeLeft--;
                    display.innerText = `00:${timeLeft < 10 ? '0'+timeLeft : timeLeft}`;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("Tempo de descanso acabou!");
                        toggleTimer();
                    }
                }, 1000);
            }
        }

        function atualizarUI() {
            document.getElementById('macro-prot').innerText = db.prot + 'g';
            document.getElementById('macro-carb').innerText = db.carb + 'g';
            document.getElementById('macro-gord').innerText = db.gord + 'g';
            document.getElementById('mural-objetivo').value = db.objetivo;
            
            let perc = Math.min(Math.round((db.kcal / db.metaKcal) * 100), 100);
            document.getElementById('barra-progresso').style.width = perc + "%";
            document.getElementById('porcentagem-texto').innerText = perc + "%";
            document.getElementById('xp-texto').innerText = `N√≠vel ${Math.floor(db.xp/100)+1} ‚Ä¢ ${db.xp} XP`;

            document.getElementById('historico-peso').innerHTML = db.histPeso.map(p => `
                <div class="bg-slate-100 dark:bg-slate-800 p-3 rounded-2xl text-center min-w-[85px]">
                    <span class="text-[9px] block text-slate-400 font-bold uppercase">${p.data}</span>
                    <span class="font-black text-sm">${p.valor}kg</span>
                </div>
            `).reverse().join('');
        }

        function adicionarAgua() { db.agua++; db.xp += 10; renderAgua(); atualizarUI(); salvar(); }
        function renderAgua() { document.getElementById('container-agua').innerHTML = "üíß".repeat(db.agua); }

        function registrarPeso() {
            const v = document.getElementById('input-peso').value;
            if(v > 20) {
                db.histPeso.push({valor: v, data: new Date().toLocaleDateString('pt-BR', {day:'2-digit', month:'2-digit'})});
                db.xp += 50; document.getElementById('input-peso').value = '';
                atualizarUI(); salvar();
            }
        }

        function compartilharNoZap() {
            const msg = `üöÄ *VITTAFLOW 3.1* %0AüèÜ XP: ${db.xp}%0AüéØ Foco: ${db.objetivo}%0Aüíß √Ågua: ${db.agua} copos%0Aüìä Meta: ${document.getElementById('porcentagem-texto').innerText}`;
            window.open(`https://api.whatsapp.com/send?text=${msg}`, '_blank');
        }

        window.onload = () => { aplicarTema(); atualizarUI(); renderAgua(); };
    </script>
</body>
</html>
