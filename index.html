<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus v20 - Apex</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --accent: #06b6d4; --bg: #020617; }
        body { background: var(--bg); color: white; margin: 0; font-family: 'Inter', system-ui, sans-serif; -webkit-tap-highlight-color: transparent; overflow-x: hidden; }
        
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.08); }
        
        /* Ajuste de Splash */
        #splash-screen {
            position: fixed; inset: 0; background: var(--bg); z-index: 10000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.6s ease;
        }
        .scanner-line {
            width: 180px; height: 2px; background: var(--accent);
            box-shadow: 0 0 20px var(--accent);
            position: absolute; animation: scan 2s infinite ease-in-out;
        }
        @keyframes scan { 0%, 100% { transform: translateY(-45px); opacity: 0.2; } 50% { transform: translateY(45px); opacity: 1; } }
        
        /* Navega√ß√£o e Conte√∫do */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .nav-active { color: var(--accent) !important; transform: translateY(-4px); filter: drop-shadow(0 0 10px var(--accent)); }
        .hide-splash { opacity: 0; pointer-events: none; }
        
        /* Bot√µes de Carga */
        .btn-active { background: var(--accent) !important; color: #020617 !important; box-shadow: 0 0 15px rgba(6, 182, 212, 0.4); }
    </style>
</head>
<body class="pb-32">

    <div id="splash-screen">
        <div class="relative w-36 h-36 flex items-center justify-center border-2 border-cyan-500/10 rounded-[2.5rem]">
            <div class="scanner-line"></div>
            <span class="text-5xl font-black text-cyan-500">N</span>
        </div>
        <div class="mt-10 text-center">
            <p id="status-txt" class="text-[9px] font-black uppercase tracking-[0.5em] text-cyan-500/60 font-mono">Verificando Protocolos...</p>
            <div class="w-40 h-1 bg-white/5 mx-auto mt-4 rounded-full overflow-hidden">
                <div id="load-bar" class="h-full bg-cyan-500 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <header class="p-5 flex justify-between items-center sticky top-0 z-50 bg-slate-950/80 backdrop-blur-xl border-b border-white/5">
        <div class="flex items-center gap-4">
            <div onclick="abrirAdmin()" class="w-12 h-12 bg-cyan-500 rounded-2xl flex items-center justify-center font-black text-slate-950 shadow-lg active:scale-90 transition-all">N</div>
            <div>
                <h1 class="text-[11px] font-black uppercase tracking-widest text-white">Nexus <span id="tier-label" class="text-cyan-400 italic">Apex</span></h1>
                <p class="text-[8px] text-emerald-500 font-bold uppercase flex items-center gap-1">
                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"></span> Sistema Blindado
                </p>
            </div>
        </div>
        <div class="text-right">
            <p id="xp-display" class="text-xs font-black text-white">0 XP</p>
            <div class="w-20 h-1.5 bg-white/10 rounded-full mt-1 overflow-hidden">
                <div id="xp-bar" class="h-full bg-cyan-500 transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>
    </header>

    <main class="max-w-md mx-auto p-5 space-y-8">
        
        <div id="dash" class="tab-content active space-y-6">
            <div class="glass p-7 rounded-[2.5rem] shadow-2xl">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-slate-900/60 p-4 rounded-2xl border border-white/5">
                        <label class="text-[9px] font-black text-slate-500 uppercase italic">Peso (kg)</label>
                        <input type="number" id="u-weight" step="0.1" inputmode="decimal" placeholder="00.0" class="bg-transparent w-full text-2xl font-black outline-none mt-1">
                    </div>
                    <div class="bg-slate-900/60 p-4 rounded-2xl border border-white/5">
                        <label class="text-[9px] font-black text-slate-500 uppercase italic">BF (%)</label>
                        <input type="number" id="u-bf" inputmode="decimal" placeholder="00" class="bg-transparent w-full text-2xl font-black outline-none mt-1">
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <p class="text-[9px] font-black text-center text-slate-600 uppercase mb-3 tracking-widest">Objetivo Principal</p>
                        <div class="flex gap-3">
                            <button onclick="setMeta('Bulking')" id="m-Bulking" class="flex-1 py-4 rounded-2xl text-[10px] font-black uppercase border border-white/10 transition-all">Bulking</button>
                            <button onclick="setMeta('Cutting')" id="m-Cutting" class="flex-1 py-4 rounded-2xl text-[10px] font-black uppercase border border-white/10 transition-all">Cutting</button>
                        </div>
                    </div>

                    <div>
                        <p class="text-[9px] font-black text-center text-slate-600 uppercase mb-3 tracking-widest">Intensidade de Treino</p>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setNivel('1')" id="n-1" class="py-3 glass rounded-xl text-[8px] font-black uppercase transition-all">Iniciante</button>
                            <button onclick="setNivel('2')" id="n-2" class="py-3 glass rounded-xl text-[8px] font-black uppercase transition-all">Militar</button>
                            <button onclick="setNivel('3')" id="n-3" class="py-3 glass rounded-xl text-[8px] font-black uppercase transition-all">Insano</button>
                        </div>
                    </div>

                    <button onclick="gerarProtocolo()" class="w-full bg-cyan-600 py-6 rounded-[2rem] font-black text-xs uppercase shadow-xl shadow-cyan-900/40 active:scale-95 transition-all">Sincronizar Protocolo AI</button>
                </div>
            </div>
            
            <div id="leaderboard" class="space-y-3"></div>
        </div>

        <div id="treinos" class="tab-content space-y-4">
            <div id="lista-exercicios" class="space-y-4 pb-12">
                <div class="text-center py-20 opacity-30">
                    <p class="text-5xl mb-4">üì°</p>
                    <p class="text-[10px] font-black uppercase tracking-widest leading-loose">Sincronize seu perfil para<br>receber o treino do dia</p>
                </div>
            </div>
        </div>

        <div id="pro-features" class="tab-content">
            <div id="lock-pro" class="glass p-12 rounded-[3rem] text-center border-orange-500/10">
                <div class="text-5xl mb-6">üß™</div>
                <h2 class="text-xl font-black uppercase text-orange-500 mb-4 tracking-tighter">Bio-IA Nutri√ß√£o</h2>
                <p class="text-[10px] text-slate-500 font-black uppercase mb-8 leading-relaxed">C√°lculos metab√≥licos de alta precis√£o e plano de macros blindado.</p>
                <button onclick="abrirModal()" class="bg-gradient-to-r from-amber-500 to-orange-600 px-10 py-5 rounded-2xl font-black text-[10px] uppercase shadow-2xl">Assinar Nexus Pro</button>
            </div>
            <div id="content-pro" class="hidden"></div>
        </div>

        <div id="hub" class="tab-content">
            <div class="glass p-6 rounded-[2.5rem]">
                <textarea id="msg-input" placeholder="O que voc√™ conquistou hoje?" class="w-full bg-slate-900/30 p-5 rounded-3xl text-sm text-white outline-none mb-4 h-28 border border-white/5 resize-none focus:border-purple-500/30 transition-all"></textarea>
                <button onclick="postar()" class="w-full bg-purple-600 py-4 rounded-2xl font-black text-[10px] uppercase shadow-lg shadow-purple-900/20">Publicar no Hub</button>
                <div id="feed" class="mt-8 space-y-4 pb-12"></div>
            </div>
        </div>
    </main>

    <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md h-20 glass rounded-[2.5rem] z-50 flex items-center justify-around px-2 shadow-2xl">
        <button onclick="nav(event, 'dash')" class="nav-item nav-active flex flex-col items-center gap-1.5 transition-all">
            <span class="text-2xl">üë§</span><span class="text-[8px] font-black uppercase">Perfil</span>
        </button>
        <button onclick="nav(event, 'treinos')" class="nav-item text-slate-500 flex flex-col items-center gap-1.5 transition-all">
            <span class="text-2xl">üí™</span><span class="text-[8px] font-black uppercase">Treino</span>
        </button>
        <button onclick="nav(event, 'pro-features')" class="nav-item text-orange-500/50 flex flex-col items-center gap-1.5 transition-all">
            <span class="text-2xl">üß™</span><span class="text-[8px] font-black uppercase">Bio-IA</span>
        </button>
        <button onclick="nav(event, 'hub')" class="nav-item text-purple-500/50 flex flex-col items-center gap-1.5 transition-all">
            <span class="text-2xl">üåç</span><span class="text-[8px] font-black uppercase">Hub</span>
        </button>
    </nav>

    <div id="modal-pay" class="fixed inset-0 bg-black/98 z-[100] hidden items-center justify-center p-6 backdrop-blur-xl">
        <div class="bg-slate-900 p-8 rounded-[3.5rem] w-full max-w-sm text-center border border-white/10 shadow-2xl">
            <h2 class="text-3xl font-black mb-2 uppercase text-white">NEXUS PRO</h2>
            <p class="text-[10px] text-orange-500 font-black mb-10 italic uppercase tracking-[0.2em]">Libera√ß√£o Vital√≠cia</p>
            <div id="qr-area" class="bg-white p-5 rounded-3xl mb-8 hidden w-52 mx-auto"><img id="qr-code" class="w-full"></div>
            <button id="btn-pix" onclick="gerarPix()" class="w-full bg-gradient-to-r from-amber-400 to-orange-600 py-6 rounded-3xl font-black text-[11px] uppercase shadow-2xl active:scale-95 transition-all">Gerar QR Code Pix</button>
            <button onclick="fecharModal()" class="mt-8 text-[10px] text-slate-600 font-black uppercase tracking-widest">Agora n√£o</button>
        </div>
    </div>

    <div id="admin-panel" class="fixed inset-0 bg-slate-950 z-[1000] hidden p-10 flex flex-col justify-center gap-4">
        <button onclick="ativarPro()" class="w-full py-6 bg-orange-600 rounded-3xl font-black uppercase text-xs">Ativar Modo Pro</button>
        <button onclick="resetApp()" class="w-full py-6 bg-red-900/20 text-red-500 rounded-3xl font-black uppercase text-xs border border-red-900/50">Reset Completo</button>
        <button onclick="document.getElementById('admin-panel').classList.add('hidden')" class="text-slate-600 uppercase text-[10px] font-black mt-10">Sair do Terminal</button>
    </div>

    <script>
        const CONFIG = { PIX: "Nandogabriel.1710@gmail.com", WHATS: "5511994025686", NOME: "Fernando Gabriel" };
        let db;

        // SISTEMA GUARDIAN DE INTEGRIDADE
        const Security = {
            sanitize: (s) => s.replace(/[<>]/g, "").trim(),
            validate: (d) => d && typeof d.xp === 'number' && 'isPro' in d
        };

        function init() {
            try {
                const data = JSON.parse(localStorage.getItem('Nexus_v20_Apex'));
                db = Security.validate(data) ? data : { xp: 0, isPro: false, meta: 'Bulking', weight: '', bf: '', nivel: '2' };
            } catch(e) { 
                db = { xp: 0, isPro: false, meta: 'Bulking', weight: '', bf: '', nivel: '2' }; 
            }
        }

        function save() { localStorage.setItem('Nexus_v20_Apex', JSON.stringify(db)); }

        window.onload = () => {
            init();
            const bar = document.getElementById('load-bar');
            const status = document.getElementById('status-txt');
            
            setTimeout(() => { bar.style.width = "40%"; status.innerText = "Sincronizando DB..."; }, 300);
            setTimeout(() => { bar.style.width = "75%"; status.innerText = "Escaneando V√≠rus..."; }, 600);
            setTimeout(() => { 
                bar.style.width = "100%"; 
                status.innerText = "Acesso Seguro Concedido";
                document.getElementById('u-weight').value = db.weight;
                document.getElementById('u-bf').value = db.bf;
                atualizarUI();
                document.getElementById('splash-screen').classList.add('hide-splash');
            }, 1200);

            // Ouvintes de input corrigidos
            document.getElementById('u-weight').onchange = (e) => { db.weight = e.target.value; save(); atualizarUI(); };
            document.getElementById('u-bf').onchange = (e) => { db.bf = e.target.value; save(); };
        };

        function atualizarUI() {
            document.getElementById('xp-display').innerText = `${db.xp.toLocaleString()} XP`;
            document.getElementById('xp-bar').style.width = Math.min((db.xp % 2000) / 20, 100) + "%";
            document.getElementById('tier-label').innerText = db.isPro ? "PRO üëë" : "APEX";

            // Estilizar bot√µes de Meta
            ['Bulking', 'Cutting'].forEach(m => {
                const b = document.getElementById('m-'+m);
                b.className = db.meta === m ? "flex-1 py-4 bg-cyan-600 rounded-2xl text-[10px] font-black uppercase text-slate-950 shadow-lg" : "flex-1 py-4 glass rounded-2xl text-[10px] font-black uppercase text-slate-500";
            });

            // Estilizar bot√µes de N√≠vel
            ['1', '2', '3'].forEach(n => {
                const b = document.getElementById('n-'+n);
                b.className = db.nivel === n ? "py-3 bg-white rounded-xl text-[8px] font-black uppercase text-slate-950" : "py-3 glass rounded-xl text-[8px] font-black uppercase text-slate-500";
            });

            // Conte√∫do PRO
            if(db.isPro) {
                document.getElementById('lock-pro').classList.add('hidden');
                const cp = document.getElementById('content-pro');
                cp.classList.remove('hidden');
                const p = parseFloat(db.weight) || 0;
                const prot = Math.round(p * 2.2);
                const kcal = db.meta === 'Bulking' ? Math.round(p * 38) : Math.round(p * 26);
                cp.innerHTML = `
                    <div class='glass p-8 rounded-[2.5rem] border-t-2 border-orange-500/30'>
                        <p class='text-center text-[10px] font-black uppercase text-orange-500 mb-6'>Apex Bio-Metabolismo</p>
                        <div class='grid grid-cols-2 gap-4 mb-6'>
                            <div class='bg-slate-950 p-5 rounded-2xl text-center border border-white/5'>
                                <p class='text-[8px] text-slate-500 font-black uppercase mb-1'>Prote√≠na</p>
                                <p class='text-2xl font-black text-orange-500'>${prot}g</p>
                            </div>
                            <div class='bg-slate-950 p-5 rounded-2xl text-center border border-white/5'>
                                <p class='text-[8px] text-slate-500 font-black uppercase mb-1'>Calorias</p>
                                <p class='text-2xl font-black text-white'>${kcal}</p>
                            </div>
                        </div>
                        <div class='space-y-2'>
                            <div class='bg-white/5 p-4 rounded-xl text-[9px] font-black uppercase italic flex justify-between'><span>CAF√â</span><span>4 Ovos + Aveia</span></div>
                            <div class='bg-white/5 p-4 rounded-xl text-[9px] font-black uppercase italic flex justify-between'><span>ALMO√áO</span><span>200g Frango + Arroz</span></div>
                            <div class='bg-white/5 p-4 rounded-xl text-[9px] font-black uppercase italic flex justify-between'><span>JANTAR</span><span>150g Carne + Vegetais</span></div>
                        </div>
                    </div>`;
            }
            renderRank();
        }

        function setMeta(m) { db.meta = m; save(); atualizarUI(); }
        function setNivel(n) { db.nivel = n; save(); atualizarUI(); }

        function gerarProtocolo() {
            const list = document.getElementById('lista-exercicios');
            const n = parseInt(db.nivel);
            const series = n === 1 ? '3x12' : n === 2 ? '4x10' : '5x8 (FALHA)';
            
            const treinos = db.meta === 'Bulking' ? [
                {n:'Supino Inclinado', s: series, x: 120*n}, {n:'Agachamento Livre', s: series, x: 150*n}, {n:'Desenvolvimento Ombro', s: series, x: 110*n}, {n:'Remada Curvada', s: series, x: 110*n}, {n:'Rosca Martelo', s: '4x15', x: 80*n}
            ] : [
                {n:'Burpees Explosivos', s: (12*n)+' Reps', x: 180*n}, {n:'Polichinelos', s: (40*n)+' Reps', x: 140*n}, {n:'Flex√£o de Bra√ßo', s: 'At√© a Falha', x: 140*n}, {n:'Prancha Isom√©trica', s: '1 Minuto', x: 120*n}, {n:'Abdominal Infra', s: '25 Reps', x: 100*n}
            ];

            list.innerHTML = `<div class='flex justify-between items-center mb-6 px-2'><h3 class='text-[10px] font-black text-cyan-500 uppercase italic'>Protocolo Ativo</h3><span class='bg-cyan-500/10 px-3 py-1 rounded-full text-[8px] font-black text-cyan-500 uppercase'>Nv ${db.nivel}</span></div>`;
            treinos.forEach((ex, i) => {
                list.innerHTML += `<div class='glass p-6 rounded-[2rem] border-l-4 border-cyan-500 flex justify-between items-center mb-4 transition-all'>
                    <div><p class='font-black uppercase text-xs text-white'>${ex.n}</p><p class='text-[9px] text-slate-500 font-bold mt-1'>${ex.s}</p></div>
                    <button onclick="addXP(this, ${ex.x})" class='w-12 h-12 bg-cyan-500/10 rounded-2xl flex items-center justify-center text-xl shadow-inner active:bg-cyan-500 active:text-slate-900 transition-all'>‚ö°</button>
                </div>`;
            });
            nav(null, 'treinos');
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function addXP(btn, v) { 
            db.xp += v; save(); atualizarUI(); 
            btn.innerHTML = 'üèÜ'; btn.disabled = true; btn.classList.add('opacity-30'); 
        }

        function renderRank() {
            const r = [{n:'Sovereign King', x:250000, s:'üëë'}, {n:'Voc√™', x:db.xp, s:'‚ö°'}].sort((a,b)=>b.x-a.x);
            document.getElementById('leaderboard').innerHTML = `<p class='text-[9px] font-black uppercase text-slate-700 mb-3 ml-2'>Ranking Global Apex</p>` + r.map((u,i)=>`<div class='bg-slate-900/40 p-5 rounded-2xl flex justify-between items-center border border-white/5 mb-2'><div class='flex items-center gap-3'><span class='text-[10px] font-black text-slate-600'>#${i+1}</span><span class='text-[10px] font-black uppercase text-white'>${u.s} ${u.n}</span></div><span class='text-[10px] font-black text-cyan-400'>${u.x.toLocaleString()} XP</span></div>`).join('');
        }

        function postar() {
            const i = document.getElementById('msg-input');
            const clean = Security.sanitize(i.value);
            if(!clean) return;
            document.getElementById('feed').innerHTML = `<div class='glass p-6 rounded-[2rem] border-l-2 border-purple-500/40 mb-4 animate-fadeInUp'><p class='text-[8px] font-black text-purple-400 mb-2 uppercase tracking-widest'>‚ö° Membro Atleta</p><p class='text-sm italic text-s
